<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style type="text/css">
    *{
        margin:0;
        padding: 0;
    }
    table{
        border-spacing: 0;
        border-collapse:0;
    }
    td{
        border:1px solid #eee;
        width:50px;
        height:50px;
        text-align:center;
        font-weight: bold;
        box-sizing:border-box;
    }
    .blank{
        border:none;
    }
    #robot-box{
        background:url(./img/QQ.jpg) no-repeat;
        background-size: contain;
        width:50px;
        height:50px;
        position:absolute;
        top:50px;
        left:50px;
        transition: all 1s;
    }
    ul{
        position:absolute;
        top:50px;
        right:50px;
        font-size:1.5rem;
    }
    </style>
</head>
<body>
    <table>
        <tr>
            <td class="blank"></td>
            <td class="blank">1</td>
            <td class="blank">2</td>
            <td class="blank">3</td>
            <td class="blank">4</td>
            <td class="blank">5</td>
            <td class="blank">6</td>
            <td class="blank">7</td>
            <td class="blank">8</td>
            <td class="blank">9</td>
            <td class="blank">10</td>
        </tr>
        <tr>
            <td class="blank">1</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td class="blank">2</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td class="blank">3</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td class="blank">4</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td class="blank">5</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td class="blank">6</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td class="blank">7</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td class="blank">8</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td class="blank">9</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td class="blank">10</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
    </table>
    <!-- <div class="robot-box" id="robot-box"></div> -->
    <input type="text" id="command_input">
    <input type="button" id="command_button" value="GO">
    <input type="button" id="turn_left" value="TUN LEF">
    <input type="button" id="turn_right"  value="TUN RIG">
    <input type="button" id="turn_back" value="TUN BAC">
    <ul>
        <li>GO：确认按钮，不填任何指令则默认向头顶朝的方向前进一格</li>
        <li>TUN LEF：向左转（逆时针旋转90度）</li>
        <li>TUN RIG：向右转（顺时针旋转90度）</li>
        <li>TUN BAC：向右转（旋转180度）</li>
        <li>TRA LEF：向屏幕的左侧移动一格，方向不变</li>
        <li>TRA TOP：向屏幕的上面移动一格，方向不变</li>
        <li>TRA RIG：向屏幕的右侧移动一格，方向不变</li>
        <li>TRA BOT：向屏幕的下面移动一格，方向不变</li>
        <li>MOV LEF：方向转向屏幕左侧，并向屏幕的左侧移动一格</li>
        <li>MOV TOP：方向转向屏幕上面，向屏幕的上面移动一格</li>
        <li>MOV RIG：方向转向屏幕右侧，向屏幕的右侧移动一格</li>
        <li>MOV BOT：方向转向屏幕下面，向屏幕的下面移动一格</li>
    </ul>
    <script type="text/javascript">
    // var robot = document.getElementById("robot_box");
    var cmd_btn = document.getElementById("command_button");
    //用GO去监听文本框的所以i不拿文本框了
    var t_left = document.getElementById("turn_left");
    var t_right = document.getElementById("turn_right");
    var t_back = document.getElementById("turn_back");
    class RobotBox {
        constructor(){
            this.deg = 0;
            this.face = 0;
            this.xPos = 50;
            this.yPos = 50;
            this.robot =  document.createElement("div");
        }
        turnLeft(){
			
            this.deg -= 90;
            this.robot.style.transform =  "rotateZ(" +this.deg + "deg)";
            this.face=(this.face+4-1)%4;
        }
        turnRight(){
            this.deg+=90;
            this.robot.style.transform = "rotateZ("+this.deg+"deg)";
            // this.robot.style="transform: rotateZ(90deg);background-color:red;";
            //这样直接修改style才需要写；
            //rotateZ里面不能写;  因为我们修改的是transform
            //style="transform: rotateZ(90deg);"自动添加;
            this.face=(this.face+1)%4;
        }
        turnBack(){
            this.deg+=180;
            this.robot.style.transform = "rotateZ("+this.deg+"deg)";
            this.face=(this.face+2)%4;
        }
        go(){
            var command_input = document.getElementById("command_input").value;
            if(command_input=="TUN LEF")
            {
                this.turnLeft();
            }
            else if(command_input=="TUN RIG"){
                this.turnRight();
            }
            else if(command_input=="TUN BAG"){
                this.turnBack();
            }
            else if(command_input=="")
            {
                if(this.face==0)
                {
                    if(this.yPos-50>=50)
                    {
                        this.yPos-=50;
                        this.robot.style.top = this.yPos+"px";
                    }
                }
                else if(this.face==1)
                {
                    if(this.xPos+50<=550)
                    {
                        this.xPos+=50;
                        this.robot.style.left = this.xPos+"px";
                    }
                }
                else if(this.face==2){
                    if(this.yPos+50<=550)
                    {
                        this.yPos+=50;
                        this.robot.style.top = this.yPos+"px";
                    }
                }
                else if(this.face==3)
                {
                    if(this.xPos-50>=50)
                    {
                        this.xPos-=50;
                        this.robot.style.left = this.xPos+"px";
                    }
                }
            }
            else if(command_input=="TRA LEF")
            {
                if(this.xPos-50>=50)
                    {
                        this.xPos-=50;
                        this.robot.style.left = this.xPos+"px";
                    }
            }
            else if(command_input=="TRA TOP")
            {
                if(this.yPos-50>=50)
                    {
                        this.yPos-=50;
                        this.robot.style.top = this.yPos+"px";
                    }
            }
            else if(command_input=="TRA RIG")
            {
                if(this.xPos+50<=550)
                    {
                        this.xPos+=50;
                        this.robot.style.top = this.xPos+"px";
                    }
            }
            else if(command_input=="TRA BOT")
            {
                if(this.yPos+50<=550)
                    {
                        this.yPos+=50;
                        this.robot.style.top = this.yPos+"px";
                    }
            }
            else if(command_input=="MOV LEF")
            {
                if(this.xPos-50>=50)
                    {
                        this.xPos-=50;
                        this.robot.style.left = this.xPos+"px";
                        this.face=3;
                        this.deg = -90;
                        this.robot.style.transform="rotateZ(-90deg)"
                        // this.robot.style.transform =  "rotateZ(" +-90 + "deg)";
                    }
            }
            else if(command_input=="MOV TOP")
            {
                if(this.yPos-50>=50)
                    {
                        this.yPos-=50;
                        this.robot.style.top = this.yPos+"px";
                        this.face=0;
                        this.deg = 0;
                        this.robot.style.transform="rotateZ(0deg)"
                    }
            }
            else if(command_input=="MOV RIG")
            {
                if(this.xPos+50<=550)
                    {
                        this.xPos+=50;
                        this.robot.style.top = this.xPos+"px";
                        this.face=1;
                        this.deg = 90;
                        this.robot.style.transform="rotateZ(90deg)"
                    }
            }
            else if(command_input=="MOV BOT")
            {
                if(this.yPos+50<=550)
                    {
                        this.yPos+=50;
                        this.robot.style.top = this.yPos+"px";
                        this.face=2;
                        this.deg = 180;

                        this.robot.style.transform="rotateZ(180deg)"

                    }
            }
            else{
                alert("输入TUN LEF或TUN RIG或TUN BAG或不输入");
            }
        }
        init(name){
            this.robot.id=name;
            document.body.appendChild(this.robot);
        }
    };
    var robot = new RobotBox("robot-box");
    robot.init("robot-box");
    // cmd_btn.addEventListener("click",robot.go,false);
    // t_left.addEventListener("click",robot.turnLeft,false);
    // t_right.addEventListener("click",robot.turnRight,false);
    // t_back.addEventListener("click",robot.turnBack,false);
    //上面这种写法，会把RoboxBox的turnLeft作为t_left的触发事件,但触发该事件的是t_left
    //相当于t_left.robot.turnLeft(),所以this指向t_left
    //所以调用时t_left的this指向t_left,所以会疯狂报错
    //两种解决方法，一种像下面，写成function然后robot.turnLeft()这样turnLeft的this指向robot
    //第二种，RobotBox里的函数改成箭头函数写法()=>{}这样函数里的this永远指向RobotBox
    cmd_btn.addEventListener("click",function(){robot.go();},false);
    t_left.addEventListener("click",function(){robot.turnLeft();},false);
    t_right.addEventListener("click",function(){robot.turnRight();},false);
    t_back.addEventListener("click",function(){robot.turnBack();},false);
    </script>
</body>
</html>